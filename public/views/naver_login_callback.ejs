<!doctype html>
<html lang="ko">
  <head>
    <%- include('./partials/head.ejs') %>
  </head>
  <body>
    <script type="text/javascript">
      $(document).ready(function() {
        $.ajax({
          url: '/api_naver_client_id',
          method: 'GET',
          success: function(response) {
            const clientId = response.clientId;
            const callbackUrl = "/"; // 콜백 URL을 입력하세요

            // 네이버 로그인 객체 생성
            var naver_id_login = new naver.LoginWithNaverId({
              clientId: clientId,
              callbackUrl: callbackUrl,
              isPopup: false
            });
            console.log(naver_id_login);


            if (location.hash) {
              const hashParams = new URLSearchParams(location.hash.slice(1));
              const access_token = hashParams.get("access_token");

              // 액세스 토큰을 세션 스토리지에 저장
              sessionStorage.setItem("naver_access_token", access_token);

              // 콜백 URL에서 메인 페이지로 리다이렉트
              window.location.href = callbackUrl;
            }
          },
          error: function(xhr, status, error) {
            console.log(error);
          }
        });
      });
    </script>
  </body>
</html>
